#include "Signature.h"

#include "../Utils.h"

#include <Logging/Logger.h>

#include <map>
#include <cstdarg>

#include <rttihelper.h>

#define VT_IDX(SIG_VT, IDX) *(void**)(((uintptr_t)pointerMap[SIG_VT]) + (sizeof(void*) * IDX));

using namespace NKHook5;
using namespace NKHook5::Signatures;
using namespace Common;
using namespace Common::Logging;
using namespace Common::Logging::Logger;

static std::map<Sigs, void*> pointerMap;

void* Signatures::FindFirst(int count, ...) {
	va_list args;
	va_start(args, count);

	void* result = nullptr;
	for (size_t i = 0; i < count; i++) {
		const char* arg = va_arg(args, const char*);
		if (!result) {
			result = (void*)Utils::FindPattern(arg);
		}
	}

	va_end(args);
	return result;
}

void Signatures::FindAll() {
	/* CApplyStatusEffectTask */
	pointerMap[Sigs::CApplyStatusEffectTask_VTable] = (void*)h_rtti::get_vtable("CApplyStatusEffectTask");
	pointerMap[Sigs::CApplyStatusEffectTask_Fire] = VT_IDX(Sigs::CApplyStatusEffectTask_VTable, 50);
	/* CBaseButton */
	pointerMap[Sigs::CBaseButton_VTable] = (void*)h_rtti::get_vtable("CBaseButton");
	pointerMap[Sigs::CBaseButton_CCTOR] = Signatures::FindFirst(1,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 53 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F9 ?? 7D ?? ?? 45 ?? ?? ?? ?? ?? 6A"
	);
	/* CBaseFileIO */
	pointerMap[Sigs::CBaseFileIO_FileExists] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? ?? 4D ?? 8B ?? 8B ?? ?? 8B ?? ?? 53 ?? 5D ?? ?? ?? ?? 8B",
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B D1 ?? 55 ?? 8B ?? ?? 8B ?? 8B"
	);
	pointerMap[Sigs::CBaseFileIO_OpenFile] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? ?? 4D ?? 8B ?? 8B ?? ?? 8B ?? ?? 57",
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? ?? 4D ?? 8B ?? 8B"
	);
	/* CBasePositionableObject */
	pointerMap[Sigs::CBasePositionableObject_AssignParent] = Signatures::FindFirst(1,
		"55 8b ec 56 8b f1 57 8b 7d ?? 8b 46 ?? 3b c7 74 ?? 85 c0 74 ?? e8 ?? ?? ?? ?? 85 ff 74 ?? 56 8b cf e8 ?? ?? ?? ?? 80 7f ?? ?? 75 ?? 8b 06 8b ce 6a ?? ff 90 ?? ?? ?? ?? 8b ce e8 ?? ?? ?? ?? 5f 5e 5d c2 ?? ?? cc cc cc cc cc cc cc cc cc cc cc 80 79"
	);
	pointerMap[Sigs::CBasePositionableObject_SetComplete] = Signatures::FindFirst(1,
		"?? 79 ?? ?? 75 ?? 56 57 8D"
	);
	/* CBaseScreen */
	pointerMap[Sigs::CBaseScreen_CCTOR] = Signatures::FindFirst(1,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F9 ?? 7D ?? 8D ?? ?? E8 ?? ?? ?? ?? ?? 45"
	);
	pointerMap[Sigs::CBaseScreen_GetScreen] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 53 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B D9 ?? 5D ?? 8B ?? ?? 8D ?? ?? ?? ?? ?? 57",
		"55 8B EC 83 EC ?? 53 8B D9 57 8B ?? ?? 57"
	);
	pointerMap[Sigs::CBaseScreen_OpenPopup] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 53 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? ?? 0F ?? ?? ?? 8B F1 ?? 75 ?? 8B",
		"55 8B EC 83 EC ?? 8B ?? ?? 53 56 57 ?? 00"
	);
	pointerMap[Sigs::CBaseScreen_StartUsingAsset] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 51 56 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F1 ?? BE ?? ?? ?? ?? ?? 75 ?? A1",
		"55 8B EC 51 56 8B F1 ?? BE ?? ?? ?? ?? ?? 75 ?? 68"
	);
	/* CBloon */
	pointerMap[Sigs::CBloon_ApplyEffect] = Signatures::FindFirst(1,
		"55 8B EC 83 EC ?? 56 8B ?? ?? 57 8B F9 85"
	);
	pointerMap[Sigs::CBloon_Update] = Signatures::FindFirst(1,
		"55 8B EC 83 EC ?? 53 56 8B ?? ?? 8B D9 56 E8 ?? ?? ?? ?? ?? BB"
	);
	/* CBloonFactory */
	pointerMap[Sigs::CBloonFactory_CCTOR] = Signatures::FindFirst(2,
		//Steam
		"55 8b ec 6a ?? 68 ?? ?? ?? ?? 64 a1 ?? ?? ?? ?? 50 81 ec ?? ?? ?? ?? a1 ?? ?? ?? ?? 33 c5 89 45 ?? 53 56 57 50 8d 45 ?? 64 a3 ?? ?? ?? ?? 8b f9 89 bd ?? ?? ?? ?? 83 ec ?? 89 bd ?? ?? ?? ?? 8b c4 89 a5 ?? ?? ?? ?? c7 00 ?? ?? ?? ?? c7 40 ?? ?? ?? ?? ?? c7 45 ?? ?? ?? ?? ?? c7 45 ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? c7 45 ?? ?? ?? ?? ?? 8d 5f ?? 89 9d ?? ?? ?? ?? 8d 73 ?? c7 03 ?? ?? ?? ?? 89 b5 ?? ?? ?? ?? c7 06 ?? ?? ?? ?? c7 46 ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? 89 06 c6 45 ?? ?? 8d 8d ?? ?? ?? ?? 6a ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? c7 07 ?? ?? ?? ?? c7 03 ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c6 85 ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? 8d 4f ?? 8d 85 ?? ?? ?? ?? 3b c8 74 ?? 6a ?? 6a ?? 50 e8 ?? ?? ?? ?? c6 45 ?? ?? 8b 85 ?? ?? ?? ?? 83 f8 ?? 72 ?? 40 6a ?? 50 ff b5 ?? ?? ?? ?? e8 ?? ?? ?? ?? 83 c4 ?? 6a ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? 8d 8d ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c6 85 ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c6 85 ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? 8d 8d ?? ?? ?? ?? 6a ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c6 85 ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? 8d 8d ?? ?? ?? ?? 6a ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c6 85 ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? 8d 8d ?? ?? ?? ?? 6a ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c6 85 ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? 8d 8d ?? ?? ?? ?? 6a ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c6 85 ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? 8d 8d ?? ?? ?? ?? 6a ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c6 85 ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? 8d 8d ?? ?? ?? ?? 6a ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c6 85 ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? 6a ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? 8d 8d ?? ?? ?? ?? 68 ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c6 85 ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? 8d 8d ?? ?? ?? ?? 6a ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c6 85 ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? 8d 8d ?? ?? ?? ?? 6a ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c6 85 ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? 8d 8d ?? ?? ?? ?? 6a ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c6 85 ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? 8d 8d ?? ?? ?? ?? 6a ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c6 85 ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? 8d 8d ?? ?? ?? ?? 6a ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c6 85 ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? 8d 8d ?? ?? ?? ?? 6a ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c6 85 ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? c6 85 ?? ?? ?? ?? ?? 6a ?? 68 ?? ?? ?? ?? 8d 8d ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? 8d 8d ?? ?? ?? ?? 6a ?? c7 45 ?? ?? ?? ?? ?? c7 45 ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? c7 45 ?? ?? ?? ?? ?? c7 45 ?? ?? ?? ?? ?? c6 85 ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? 8d 4d ?? 6a ?? c7 45 ?? ?? ?? ?? ?? c7 45 ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? c7 45 ?? ?? ?? ?? ?? c7 45 ?? ?? ?? ?? ?? c6 45 ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? 8d 4d ?? 6a ?? c7 45 ?? ?? ?? ?? ?? c7 45 ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? c7 45 ?? ?? ?? ?? ?? c7 45 ?? ?? ?? ?? ?? c6 45 ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? 8d 4d ?? 68 ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? 8d 4d ?? 68 ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? 8d 8d ?? ?? ?? ?? 68 ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? 8d 8d ?? ?? ?? ?? 68 ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? 8d 8d ?? ?? ?? ?? 68 ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? 8d 8d ?? ?? ?? ?? 68 ?? ?? ?? ?? e8 ?? ?? ?? ?? c6 45 ?? ?? 8d 8d",
		//Kong
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 81 EC ?? ?? ?? ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F9 ?? BD ?? ?? ?? ?? 83 EC ?? ?? BD ?? ?? ?? ?? 8B C4 ?? 00 ?? ?? ?? ?? ?? 40 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D ?? ?? ?? 45 ?? ?? ?? ?? ?? 8D ?? ?? ?? 03 ?? ?? ?? ?? ?? 9D ?? ?? ?? ?? ?? B5 ?? ?? ?? ?? ?? 06 ?? ?? ?? ?? ?? 46 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? ?? 06 ?? 45 ?? ?? 8D ?? ?? ?? ?? ?? 6A ?? 68 ?? ?? ?? ?? ?? 07 ?? ?? ?? ?? ?? 03 ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D ?? ?? ?? 45 ?? ?? 8D ?? ?? ?? ?? ?? 3B C8 74 ?? 6A ?? 6A ?? 50 E8 ?? ?? ?? ?? ?? 45 ?? ?? 8B ?? ?? ?? ?? ?? 83 F8 ?? 72 ?? 40 6A ?? 50 ?? ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 C4 ?? 6A ?? 68 ?? ?? ?? ?? 8D ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? ?? 45 ?? ?? 8D ?? ?? ?? ?? ?? 6A ?? 68 ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? ?? 45 ?? ?? 8D ?? ?? ?? ?? ?? 6A ?? 68 ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? ?? 45 ?? ?? 8D ?? ?? ?? ?? ?? 6A ?? 68 ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? ?? 45 ?? ?? 8D ?? ?? ?? ?? ?? 6A ?? 68 ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? ?? 45 ?? ?? 8D ?? ?? ?? ?? ?? 6A ?? 68 ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? ?? 45 ?? ?? 8D ?? ?? ?? ?? ?? 6A ?? 68 ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? ?? 45 ?? ?? 8D ?? ?? ?? ?? ?? 6A ?? 68 ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? ?? 45 ?? ?? 8D ?? ?? ?? ?? ?? 6A ?? 68 ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? ?? 45 ?? ?? 68"
	);
	/* CBloonsBaseScreen */
	pointerMap[Sigs::CBloonsBaseScreen_CCTOR] = Signatures::FindFirst(1,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F9 ?? 7D ?? 8D ?? ?? E8 ?? ?? ?? ?? ?? 45"
	);
	/* CBloonsTD5Game */
	pointerMap[Sigs::CBloonsTD5Game_CCTOR] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 53 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F1 ?? 75 ?? E8 ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? ?? 86",
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 51 56 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F1 ?? 75 ?? E8 ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? ?? 86 ?? ?? ?? ?? ?? ?? ?? ?? ?? 86 ?? ?? ?? ?? ?? ?? ?? ?? ?? 86 ?? ?? ?? ?? ?? ?? ?? ?? ?? 86 ?? ?? ?? ?? ?? ?? ?? ?? ?? 86"
	);
	pointerMap[Sigs::CBloonsTD5Game_LoadAssets] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 81 EC ?? ?? ?? ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F1 ?? B5 ?? ?? ?? ?? 6A ?? ?? 85",
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 81 EC ?? ?? ?? ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F9 ?? BD ?? ?? ?? ?? 6A"
	);
	/* CCollectableTask */
	pointerMap[Sigs::CCollectableTask_Clone] = Signatures::FindFirst(1,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 51 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F1 8B ?? ?? ?? ?? ?? 68"
	);
	pointerMap[Sigs::CCollectableTask_GiveContentsAndDie] = Signatures::FindFirst(1,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 53 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F9 F3"
	);
	pointerMap[Sigs::CCollectableTask_Update] = Signatures::FindFirst(1,
		"55 8B EC 56 8B F1 ?? BE ?? ?? ?? ?? ?? 0F ?? ?? ?? ?? ?? F3"
	);
	/* CDGSplashScreen */
	pointerMap[Sigs::CDGSplashScreen_VTable] = (void*)h_rtti::get_vtable("CDGSplashScreen");
	pointerMap[Sigs::CDGSplashScreen_Init] = VT_IDX(Sigs::CDGSplashScreen_VTable, 2);
	pointerMap[Sigs::CDGSplashScreen_Hide] = VT_IDX(Sigs::CDGSplashScreen_VTable, 5);

	/* CFile */
	pointerMap[Sigs::CFile_ReadBytes] = Signatures::FindFirst(1,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B ?? ?? 8B ?? ?? 8B ?? 52"
	);
	/* CFlagStringConvertor */
	pointerMap[Sigs::CFlagStringConvertor_FlagToString] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 85",
		"55 8B EC 83 EC ?? 56 57 ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? E8"
	);
	pointerMap[Sigs::CFlagStringConvertor_LoadCategory] = Signatures::FindFirst(2,
		//Kongregate
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 53 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B D9 ?? 45 ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? 8B ?? ?? 85",
		//Steam
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 53 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? ?? 4D ?? 33"
	);
	pointerMap[Sigs::CFlagStringConvertor_StringToFlag] = Signatures::FindFirst(1,
		"55 8B EC 83 EC ?? 53 56 57 ?? ?? ?? E8"
	);
	/* CFontManager */
	pointerMap[Sigs::CFontManager_GetFont] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? 8D ?? ?? 8B",
		"55 8B EC 83 EC ?? 53 8B ?? ?? 56 57 8D"
	);
	/* CGameScreen */
	pointerMap[Sigs::CGameScreen_Init] = Signatures::FindFirst(1,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 81 EC ?? ?? ?? ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B D9 ?? 9D ?? ?? ?? ?? 8B ?? ?? 56"
	);
	/* CGlueStatusEffect */
	pointerMap[Sigs::CGlueStatusEffect_VTable] = (void*)h_rtti::get_vtable("CGlueStatusEffect");
	pointerMap[Sigs::CGlueStatusEffect_CCTOR] = Signatures::FindFirst(2,
		//Steam
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 0F 28 ?? ?? 0F ?? ?? ?? 8B F9 ?? 7D ?? 8B ?? ?? ?? 07 ?? ?? ?? ?? ?? 47 ?? ?? ?? ?? ?? ?? 47 ?? ?? ?? 47 ?? ?? ?? ?? ?? ?? 47 ?? ?? ?? ?? ?? ?? 47 ?? ?? ?? 47 ?? ?? ?? ?? ?? ?? 47 ?? ?? 47 ?? ?? 47 ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? F3",
		//Kong
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 0F 28 ?? ?? 0F ?? ?? ?? 8B F9 ?? 7D ?? 8B ?? ?? F3"
	);
	/* CLoc */
	pointerMap[Sigs::CLoc_FindText] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F1 8B ?? ?? 8B ?? ?? 85 FF",
		"55 8B EC 83 E4 ?? 83 EC ?? A1 34 ?? ?? ?? 33 C4 ?? 44 ?? ?? 53 8B ?? ?? 56 57 8B ?? ?? 8B"
	);
	pointerMap[Sigs::CLoc_GetText] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F9 8B ?? ?? 8B ?? ?? 8B ?? ?? ?? 75 ?? ?? 45",
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F9 8B ?? ?? 8B ?? ?? 8B ?? ?? ?? 45 ?? ?? ?? ?? ?? 85 C9 75 ?? ?? 4F ?? 75 ?? 50"
	);
	/* CMainButton */
	pointerMap[Sigs::CMainButton_CCTOR] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F9 ?? 7D ?? 8B ?? ?? 8B ?? ?? 8B",
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 53 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B D9 ?? 5D ?? 8B ?? ?? 8B ?? ?? 8B ?? ?? ?? 5D"
	);
	/* CPlayerProfileV1 */
	pointerMap[Sigs::CPlayerProfileV1_InternalLoad] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 81 EC ?? ?? ?? ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? ?? 65 ?? 8B D9 ?? 9D ?? ?? ?? ?? ?? 9D ?? ?? ?? ?? 8B ?? ?? ?? BD",
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 81 EC ?? ?? ?? ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? ?? 65 ?? 8B F9 ?? BD ?? ?? ?? ?? 8B ?? ?? ?? BD"
	);
	pointerMap[Sigs::CPlayerProfileV1_Save] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 B8 B0",
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 B8 78"
	);
	/* CPopupScreenBase */
	pointerMap[Sigs::CPopupScreenBase_VTable] = (void*)h_rtti::get_vtable("CPopupScreenBase");
	pointerMap[Sigs::CPopupScreenBase_CCTOR] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 56 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F1 ?? 75 ?? ?? 75 ?? ?? 45 ?? ?? ?? ?? ?? 8D ?? ?? ?? ?? ?? 50",
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 56 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F1 ?? 75 ?? ?? 75 ?? 8D ?? ?? ?? 45 ?? ?? ?? ?? ?? 50"
	);
	pointerMap[Sigs::CPopupScreenBase_AddObject] = Signatures::FindFirst(1,
		"55 8B EC 53 8B D9 B8 67 ?? ?? ?? 8B"
	);
	pointerMap[Sigs::CPopupScreenBase_AddNavButton] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 81 EC ?? ?? ?? ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F9 ?? BD ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? ?? 45",
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 81 EC ?? ?? ?? ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B D9 ?? 45 ?? ?? ?? ?? ?? 33"
	);
	pointerMap[Sigs::CPopupScreenBase_AddToPoppingList] = Signatures::FindFirst(1,
		"55 8B EC 53 56 8B ?? ?? 8B D9 57 8B ?? ?? 85 FF"
	);
	/* CProjectile */
	pointerMap[Sigs::CProjectile_VTable] = (void*)h_rtti::get_vtable("CProjectile");
	pointerMap[Sigs::CProjectile_CCTOR_A] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F9 ?? 7D ?? ?? ?? ?? E8 ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? 8D ?? ?? ?? ?? ?? ?? 55 ?? ?? 02 ?? ?? ?? ?? ?? 45 ?? ?? ?? 02 ?? ?? ?? ?? ?? 42 ?? ?? ?? ?? ?? ?? 45 ?? ?? 8D ?? ?? ?? ?? ?? ?? 45 ?? ?? 00 ?? ?? ?? ?? ?? 45 ?? ?? ?? 00 ?? ?? ?? ?? ?? 40 ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? 07 ?? ?? ?? ?? ?? 02 ?? ?? ?? ?? ?? 00 ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 45 ?? ?? 8D ?? ?? ?? ?? ?? ?? 75 ?? ?? 06 ?? ?? ?? ?? ?? 46 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? ?? 06 ?? 45 ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? C7 ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 45 ?? ?? F3 ?? ?? ?? ?? ?? 0F ?? ?? ?? ?? ?? ?? F3 ?? ?? ?? ?? ?? 0F ?? ?? ?? ?? ?? ?? ?? 7F ?? ?? 75 ?? 8D ?? ?? ?? 47 ?? ?? 8B ?? 3B C2 74 ?? 85 C0 74 ?? 8D ?? ?? EB ?? 33 C9 E8 ?? ?? ?? ?? 8B ?? 3B C2 75 ?? 68 ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 C4 ?? ?? 45 ?? ?? 45 ?? ?? 8B",
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F9 ?? 7D ?? ?? ?? ?? E8 ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 07 ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 45 ?? ?? 8D ?? ?? ?? ?? ?? ?? 75 ?? ?? 06 ?? ?? ?? ?? ?? 46 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? ?? 06 ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? C7 ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 45 ?? ?? F3 ?? ?? ?? ?? ?? 0F ?? ?? ?? ?? ?? ?? F3 ?? ?? ?? ?? ?? 0F ?? ?? ?? ?? ?? ?? ?? 7F ?? ?? 75 ?? 8D ?? ?? ?? 47 ?? ?? 8B ?? 3B C2 74 ?? 85 C0 74 ?? 8D ?? ?? EB ?? 33 C9 E8 ?? ?? ?? ?? 8B ?? 3B C2 75 ?? 68 ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 C4 ?? ?? 45 ?? ?? 45"
	);
	pointerMap[Sigs::CProjectile_CCTOR_B] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F9 ?? 7D ?? ?? ?? ?? E8 ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? 8D ?? ?? ?? ?? ?? ?? 55 ?? ?? 02 ?? ?? ?? ?? ?? 45 ?? ?? ?? 02 ?? ?? ?? ?? ?? 42 ?? ?? ?? ?? ?? ?? 45 ?? ?? 8D ?? ?? ?? ?? ?? ?? 45 ?? ?? 00 ?? ?? ?? ?? ?? 45 ?? ?? ?? 00 ?? ?? ?? ?? ?? 40 ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? 07 ?? ?? ?? ?? ?? 02 ?? ?? ?? ?? ?? 00 ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 45 ?? ?? 8D ?? ?? ?? ?? ?? ?? 75 ?? ?? 06 ?? ?? ?? ?? ?? 46 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? ?? 06 ?? 45 ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? C7 ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 45 ?? ?? F3 ?? ?? ?? ?? ?? 0F ?? ?? ?? ?? ?? ?? F3 ?? ?? ?? ?? ?? 0F ?? ?? ?? ?? ?? ?? ?? 7F ?? ?? 75 ?? 8D ?? ?? ?? 47 ?? ?? 8B ?? 3B C2 74 ?? 85 C0 74 ?? 8D ?? ?? EB ?? 33 C9 E8 ?? ?? ?? ?? 8B ?? 3B C2 75 ?? 68 ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 C4 ?? ?? 45 ?? ?? 45 ?? ?? 8D ?? ?? 6A ?? 6A ?? 51 8B C8 ?? 45 ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B F0 ?? 45 ?? ?? 8B ?? ?? ?? B7 ?? ?? ?? ?? ?? 45 ?? ?? ?? 45 ?? ?? 85 C0 74 ?? 8D ?? ?? ?? 86 ?? ?? ?? ?? 51 8D ?? ?? 51 50 8B CE E8 ?? ?? ?? ?? 8B ?? ?? 3B",
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F9 ?? 7D ?? ?? ?? ?? E8 ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 07 ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 45 ?? ?? 8D ?? ?? ?? ?? ?? ?? 75 ?? ?? 06 ?? ?? ?? ?? ?? 46 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? ?? 06 ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? C7 ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 45 ?? ?? F3 ?? ?? ?? ?? ?? 0F ?? ?? ?? ?? ?? ?? F3 ?? ?? ?? ?? ?? 0F ?? ?? ?? ?? ?? ?? ?? 7F ?? ?? 75 ?? 8D ?? ?? ?? 47 ?? ?? 8B ?? 3B C2 74 ?? 85 C0 74 ?? 8D ?? ?? EB ?? 33 C9 E8 ?? ?? ?? ?? 8B ?? 3B C2 75 ?? 68 ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 C4 ?? ?? 45 ?? 6A ?? 6A ?? 8D ?? ?? ?? 45 ?? ?? 51 8B C8 ?? 45 ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B F0 ?? 45 ?? ?? 8B ?? ?? ?? B7 ?? ?? ?? ?? ?? 45 ?? ?? ?? 45 ?? ?? 85 C0 74 ?? 8D ?? ?? ?? 86 ?? ?? ?? ?? 51 8D ?? ?? 51 50 8B CE E8 ?? ?? ?? ?? 8B ?? ?? 3B"
	);
	pointerMap[Sigs::CProjectile_CCTOR_C] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F9 ?? 7D ?? ?? ?? ?? E8 ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? 8D ?? ?? ?? ?? ?? ?? 55 ?? ?? 02 ?? ?? ?? ?? ?? 45 ?? ?? ?? 02 ?? ?? ?? ?? ?? 42 ?? ?? ?? ?? ?? ?? 45 ?? ?? 8D ?? ?? ?? ?? ?? ?? 45 ?? ?? 00 ?? ?? ?? ?? ?? 45 ?? ?? ?? 00 ?? ?? ?? ?? ?? 40 ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? 07 ?? ?? ?? ?? ?? 02 ?? ?? ?? ?? ?? 00 ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 45 ?? ?? 8D ?? ?? ?? ?? ?? ?? 75 ?? ?? 06 ?? ?? ?? ?? ?? 46 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? ?? 06 ?? 45 ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? C7 ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 45 ?? ?? F3 ?? ?? ?? ?? ?? 0F ?? ?? ?? ?? ?? ?? F3 ?? ?? ?? ?? ?? 0F ?? ?? ?? ?? ?? ?? ?? 7F ?? ?? 75 ?? 8D ?? ?? ?? 47 ?? ?? 8B ?? 3B C2 74 ?? 85 C0 74 ?? 8D ?? ?? EB ?? 33 C9 E8 ?? ?? ?? ?? 8B ?? 3B C2 75 ?? 68 ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 C4 ?? ?? 45 ?? ?? 45 ?? ?? 8D ?? ?? 6A ?? 6A ?? 51 8B C8 ?? 45 ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B F0 ?? 45 ?? ?? 8B ?? ?? ?? B7 ?? ?? ?? ?? ?? 45 ?? ?? ?? 45 ?? ?? 85 C0 74 ?? 8D ?? ?? ?? 86 ?? ?? ?? ?? 51 8D ?? ?? 51 50 8B CE E8 ?? ?? ?? ?? 8B ?? ?? 8B",
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F9 ?? 7D ?? ?? ?? ?? E8 ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 07 ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 45 ?? ?? 8D ?? ?? ?? ?? ?? ?? 75 ?? ?? 06 ?? ?? ?? ?? ?? 46 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? ?? 06 ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? C7 ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 87 ?? ?? ?? ?? ?? ?? ?? ?? ?? 45 ?? ?? F3 ?? ?? ?? ?? ?? 0F ?? ?? ?? ?? ?? ?? F3 ?? ?? ?? ?? ?? 0F ?? ?? ?? ?? ?? ?? ?? 7F ?? ?? 75 ?? 8D ?? ?? ?? 47 ?? ?? 8B ?? 3B C2 74 ?? 85 C0 74 ?? 8D ?? ?? EB ?? 33 C9 E8 ?? ?? ?? ?? 8B ?? 3B C2 75 ?? 68 ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 C4 ?? ?? 45 ?? 6A ?? 6A ?? 8D ?? ?? ?? 45 ?? ?? 51 8B C8 ?? 45 ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B F0 ?? 45 ?? ?? 8B ?? ?? ?? B7 ?? ?? ?? ?? ?? 45 ?? ?? ?? 45 ?? ?? 85 C0 74 ?? 8D ?? ?? ?? 86 ?? ?? ?? ?? 51 8D ?? ?? 51 50 8B CE E8 ?? ?? ?? ?? 8B ?? ?? 8B"
	);
	pointerMap[Sigs::CProjectile_Clone] = VT_IDX(Sigs::CProjectile_VTable, 47);
	pointerMap[Sigs::CProjectile_Update] = VT_IDX(Sigs::CProjectile_VTable, 2);
	/* CSettingsScreen */
	pointerMap[Sigs::CSettingsScreen_VTable] = (void*)h_rtti::get_vtable("CSettingsScreen");
	pointerMap[Sigs::CSettingsScreen_CCTOR] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 56 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F1 ?? 75 ?? 83 EC ?? 8B CC ?? 65 ?? 6A ?? ?? 41 ?? ?? ?? ?? ?? ?? 41 ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? ?? 01 ?? E8 ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? 8B CE E8 ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? ?? 06 ?? ?? ?? ?? ?? 86 ?? ?? ?? ?? ?? ?? ?? ?? ?? 86 ?? ?? ?? ?? ?? ?? 86",
		"55 8B EC 51 56 83 EC ?? 8B F1 8B CC ?? 75 ?? 6A ?? ?? 41 ?? ?? ?? ?? ?? ?? 41 ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? ?? 01 ?? E8 ?? ?? ?? ?? ?? ?? ?? 8B CE E8 ?? ?? ?? ?? ?? 06 ?? ?? ?? ?? 8B C6 ?? 86 ?? ?? ?? ?? ?? ?? ?? ?? ?? 86 ?? ?? ?? ?? ?? ?? 86"
	);
	pointerMap[Sigs::CSettingsScreen_Hide] = VT_IDX(Sigs::CSettingsScreen_VTable, 5);
	pointerMap[Sigs::CSettingsScreen_InitLayout] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 81 EC ?? ?? ?? ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B D9 ?? 9D ?? ?? ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 6A",
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 81 EC ?? ?? ?? ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B D9 ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 ?? ?? ?? ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 6A"
	);
	pointerMap[Sigs::CSettingsScreen_Input] = Signatures::FindFirst(1,
		"55 8B EC 56 57 8B ?? ?? 8B F1 57 E8 ?? ?? ?? ?? 8B ?? ?? ?? ?? ?? 85 C9 74 ?? 8B ?? ?? ?? ?? ?? 81 C1 ?? ?? ?? ?? 57 ?? ?? ?? 8B ?? ?? ?? ?? ?? 57"
	);
	pointerMap[Sigs::CSettingsScreen_Process] = VT_IDX(Sigs::CSettingsScreen_VTable, 16); //*(void**)((*(uintptr_t*)pointerMap[Sigs::CSettingsScreen_VTable]) + (sizeof(void*) * 16));
	/* CSprite */
	pointerMap[Sigs::CSprite_VTable] = (void*)h_rtti::get_vtable("CSprite");
	pointerMap[Sigs::CSprite_CCTOR] = Signatures::FindFirst(1,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 51 56 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F1 ?? 75 ?? E8 ?? ?? ?? ?? 8A"
	);
	pointerMap[Sigs::CSprite_SetTexture] = Signatures::FindFirst(1,
		"55 8B EC 56 8B F1 8B ?? ?? 85 C9 0F"
	);
	/* CStatusEffect */
	pointerMap[Sigs::CStatusEffect_IncTowerRef] = Signatures::FindFirst(1,
		"55 8B EC 8B ?? ?? 85 C0 74 ?? ?? ?? ?? ?? ?? ?? 8B ?? ?? ?? 41"
	);
	/* CTextObject */
	pointerMap[Sigs::CTextObject_VTable] = (void*)h_rtti::get_vtable("CTextObject");
	pointerMap[Sigs::CTextObject_CCTOR_A] = Signatures::FindFirst(1,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 51 56 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F1 ?? 75 ?? E8 ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? 8D"
	);
	pointerMap[Sigs::CTextObject_CCTOR_B] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B D9 ?? 5D ?? 8B ?? ?? 8B ?? ?? ?? 5D ?? ?? 45 ?? E8",
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F1 ?? 75 ?? 8B ?? ?? 8B ?? ?? ?? 75 ?? ?? 45"
	);
	pointerMap[Sigs::CTextObject_CCTOR_C] = Signatures::FindFirst(2,
		//Kongregate
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F9 ?? 7D ?? 8B ?? ?? 8B ?? ?? ?? 7D ?? ?? 45 ?? E8",
		//Steam
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B D9 ?? 5D ?? ?? 5D ?? 8B"
	);
	/* CTextureManager */
	pointerMap[Sigs::CTextureManager_GetSpriteInfoPtr] = Signatures::FindFirst(1,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 81 EC ?? ?? ?? ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B C1 ?? 45 ?? 8B ?? ?? 8D"
	);
	/* CTowerFactory */
	pointerMap[Sigs::CTowerFactory_CCTOR] = Signatures::FindFirst(2,
		//Kongregate
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 81 EC ?? ?? ?? ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F9 ?? BD ?? ?? ?? ?? ?? BD ?? ?? ?? ?? 83",
		//Steam
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 81 EC ?? ?? ?? ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F9 ?? BD ?? ?? ?? ?? ?? BD ?? ?? ?? ?? ?? 45"
	);
	pointerMap[Sigs::CTowerFactory_GetTowerInfo] = Signatures::FindFirst(1,
		//Kongregate
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 56 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F1 8B ?? ?? 8B ?? ?? 50 51 6A"
	);
	pointerMap[Sigs::CTowerFactory_GetTowerName] = Signatures::FindFirst(1,
		//Kongregate
		"55 8b ec 6a ?? 68 ?? ?? ?? ?? 64 a1 ?? ?? ?? ?? 50 83 ec ?? a1 ?? ?? ?? ?? 33 c5 89 45 ?? 53 56 57 50 8d 45 ?? 64 a3 ?? ?? ?? ?? 8b f9 8b 45 ?? 8b 5d ?? 8b 75 ?? 50 53 89 45 ?? c7 45 ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? 85 c0 0f 84 ?? ?? ?? ?? ff 75 ?? 8d 45 ?? 53 6a ?? 50 8d 4f ?? e8 ?? ?? ?? ?? c7 45 ?? ?? ?? ?? ?? 83 78 ?? ?? 72 ?? 8b 00 50 83 ec ?? 8b cc 68 ?? ?? ?? ?? e8 ?? ?? ?? ?? 8d 45 ?? 50 e8 ?? ?? ?? ?? 83 c4 ?? c6 45 ?? ?? 8b 45 ?? 83 f8 ?? 72 ?? 6a ?? 40 50 ff 75 ?? e8 ?? ?? ?? ?? 83 c4 ?? 8b 4f ?? 8d 45 ?? 6a ?? 50 56 8b 49 ?? c7 45 ?? ?? ?? ?? ?? c7 45 ?? ?? ?? ?? ?? c6 45 ?? ?? e8 ?? ?? ?? ?? 8b 4d ?? 83 f9 ?? 72 ?? 6a ?? 41 51 ff 75 ?? e8 ?? ?? ?? ?? 83 c4 ?? eb ?? 6a ?? 8d 47 ?? c7 46 ?? ?? ?? ?? ?? 6a ?? c7 46 ?? ?? ?? ?? ?? 8b ce 50 c6 06 ?? e8 ?? ?? ?? ?? 8b c6 8b 4d ?? 64 89 0d ?? ?? ?? ?? 59 5f 5e 5b 8b 4d ?? 33 cd e8 ?? ?? ?? ?? 8b e5 5d c2 ?? ?? cc cc cc cc cc cc cc cc cc cc cc cc 55 8b ec 6a ?? 68 ?? ?? ?? ?? 64 a1 ?? ?? ?? ?? 50 83 ec ?? a1 ?? ?? ?? ?? 33 c5 89 45 ?? 53 56 57 50 8d 45 ?? 64 a3 ?? ?? ?? ?? 8b f9 8b 45 ?? 8b 5d ?? 8b 75 ?? 50 53 89 45 ?? c7 45 ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? 85 c0 74"
	);
	/* CUnzippedFile */
	pointerMap[Sigs::CUnzippedFile_CCTOR] = Signatures::FindFirst(2,
		"56 8B F1 8D ?? ?? ?? 06 ?? ?? ?? ?? E8 ?? ?? ?? ?? ?? 46 ?? ?? ?? ?? ?? 8B",
		"c7 01 ?? ?? ?? ?? 8b c1 c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c6 41 ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c3"
	);
	/* CWeapon */
	pointerMap[Sigs::CWeapon_Fire] = Signatures::FindFirst(1,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 81 EC ?? ?? ?? ?? 53 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B D9 8B ?? ?? 85"
	);
	/* CWeaponFactory */
	pointerMap[Sigs::CWeaponFactory_CCTOR] = Signatures::FindFirst(2,
		//Steam
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 B8 50",
		//Kong
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 B8 4C"
	);
	pointerMap[Sigs::CWeaponFactory_ParseTask] = Signatures::FindFirst(2,
		"53 8B DC 83 EC ?? 83 E4 ?? 83 C4 ?? 55 8B ?? ?? ?? 6C ?? ?? 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 51 53 81 EC ?? ?? ?? ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? ?? 65 ?? 8B F9 ?? BD ?? ?? ?? ?? 8B",
		"53 8B DC 83 EC ?? 83 E4 ?? 83 C4 ?? 55 8B ?? ?? ?? 6C ?? ?? 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 51 53 81 EC ?? ?? ?? ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? ?? 65 ?? 8B F9 8A"
	);
	/* CZipFile */
	pointerMap[Sigs::CZipFile_CCTOR] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 53 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B D9 ?? 5D ?? E8 ?? ?? ?? ?? ?? 45",
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 53 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F9 ?? 7D ?? ?? 47 ?? ?? ?? ?? ?? ?? 47 ?? ?? ?? ?? ?? ?? 47"
	);
	pointerMap[Sigs::CZipFile_LoadFrom] = Signatures::FindFirst(2,
		//Kartridge
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 81 EC ?? ?? ?? ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F1 ?? 75 ?? 8B ?? ?? 8B",
		//Steam
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 81 EC ?? ?? ?? ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B D9 8B ?? ?? 8B ?? ?? ?? 45"
	);
	pointerMap[Sigs::CZipFile_Open] = Signatures::FindFirst(1,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 81 EC ?? ?? ?? ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F1 8B ?? ?? E8"
	);
	/* IBasePointers */
	pointerMap[Sigs::IBasePointers_CCTOR] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? ?? 01 ?? ?? ?? ?? ?? 41 ?? ?? ?? ?? ?? ?? 41 ?? ?? ?? ?? ?? ?? 41 ?? ?? ?? ?? ?? ?? 41 ?? ?? ?? ?? ?? ?? 41 ?? ?? ?? ?? ?? ?? 41 ?? ?? ?? ?? ?? ?? 41 ?? ?? ?? ?? ?? ?? 41 ?? ?? ?? ?? ?? ?? 41 ?? ?? ?? ?? ?? ?? 41 ?? ?? ?? ?? ?? ?? 41",
		"c7 01 ?? ?? ?? ?? 8b c1 c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? c3"
	);
	/* IScreenData */
	pointerMap[Sigs::IScreenData_VTable] = (void*)h_rtti::get_vtable("IScreenData");
	/* JsonObject */
	pointerMap[Sigs::JsonObject_ReadBoolProperty] = Signatures::FindFirst(1,
		//Kong
		"55 8b ec 6a ?? 68 ?? ?? ?? ?? 64 a1 ?? ?? ?? ?? 50 83 ec ?? 56 a1 ?? ?? ?? ?? 33 c5 50 8d 45 ?? 64 a3 ?? ?? ?? ?? 8b f1 83 ec ?? c7 45 ?? ?? ?? ?? ?? 8b cc 8d 45 ?? 6a ?? 6a ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? 50 c6 01 ?? e8 ?? ?? ?? ?? ff 75 ?? 8b ce e8 ?? ?? ?? ?? 8b 45 ?? 83 f8 ?? 72 ?? 6a ?? 40 50 ff 75 ?? e8 ?? ?? ?? ?? 83 c4 ?? 8b 4d ?? 64 89 0d ?? ?? ?? ?? 59 5e 8b e5 5d c2 ?? ?? cc cc cc cc cc cc cc cc cc cc cc 55 8b ec 6a ?? 68 ?? ?? ?? ?? 64 a1 ?? ?? ?? ?? 50 83 ec ?? 56 a1 ?? ?? ?? ?? 33 c5 50 8d 45 ?? 64 a3 ?? ?? ?? ?? 8b f1 83 ec ?? c7 45 ?? ?? ?? ?? ?? 8b cc 8d 45 ?? 6a ?? 6a ?? c7 41 ?? ?? ?? ?? ?? c7 41 ?? ?? ?? ?? ?? 50 c6 01 ?? e8 ?? ?? ?? ?? ff 75 ?? 8b ce e8 ?? ?? ?? ?? 8b 45 ?? 83 f8 ?? 72 ?? 6a ?? 40 50 ff 75 ?? e8 ?? ?? ?? ?? 83 c4 ?? 8b 4d ?? 64 89 0d ?? ?? ?? ?? 59 5e 8b e5 5d c2 ?? ?? cc cc cc cc cc cc cc cc cc cc cc 55 8b ec 6a"
	);
	pointerMap[Sigs::JsonObject_ReadIntProperty] = Signatures::FindFirst(1,
		//Kong
		"55 8b ec 6a ?? 68 ?? ?? ?? ?? 64 a1 ?? ?? ?? ?? 50 83 ec ?? 56 57 a1 ?? ?? ?? ?? 33 c5 50 8d 45 ?? 64 a3 ?? ?? ?? ?? 8b f1 8b 7d ?? c7 45 ?? ?? ?? ?? ?? 8d 4d"
	);
	/* Screens */
	pointerMap[Sigs::Screens_GetScreenForParadigm] = Signatures::FindFirst(2,
		//Win
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F1 8B ?? ?? ?? 45 ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? 45 ?? ?? ?? ?? ?? 83",
		//Kong
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F1 8B ?? ?? ?? 45 ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? 45"
	);
	/* ScriptedScreen */
	pointerMap[Sigs::ScriptedScreen_VTable] = (void*)h_rtti::get_vtable("ScriptedScreen");
	pointerMap[Sigs::ScriptedScreen_CCTOR] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 56 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F1 ?? 75 ?? 83 EC ?? 8B CC ?? 65 ?? 6A ?? ?? 41 ?? ?? ?? ?? ?? ?? 41 ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? ?? 01 ?? E8 ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? 8B CE E8 ?? ?? ?? ?? ?? 45 ?? ?? ?? ?? ?? 8D ?? ?? ?? ?? ?? ?? 06 ?? ?? ?? ?? 8B",
		"55 8B EC 51 56 83 EC ?? 8B F1 8B CC ?? 75 ?? 6A ?? ?? 41 ?? ?? ?? ?? ?? ?? 41 ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? ?? 01 ?? E8 ?? ?? ?? ?? ?? ?? ?? 8B CE E8 ?? ?? ?? ?? ?? 06 ?? ?? ?? ?? 8B C6 ?? 86 ?? ?? ?? ?? ?? ?? ?? ?? ?? 86 ?? ?? ?? ?? ?? ?? ?? ?? ?? 86 ?? ?? ?? ?? ?? ?? ?? ?? ?? 86 ?? ?? ?? ?? ?? ?? ?? ?? ?? 86 ?? ?? ?? ?? ?? ?? ?? ?? ?? 86 ?? ?? ?? ?? ?? ?? ?? ?? ?? 86 ?? ?? ?? ?? ?? ?? ?? ?? ?? 86 ?? ?? ?? ?? ?? ?? ?? ?? ?? 86 ?? ?? ?? ?? ?? ?? ?? ?? ?? 86 ?? ?? ?? ?? ?? ?? ?? ?? ?? 86 ?? ?? ?? ?? ?? ?? ?? ?? ?? 86 ?? ?? ?? ?? ?? ?? ?? ?? ?? 86 ?? ?? ?? ?? ?? ?? ?? ?? ?? 86 ?? ?? ?? ?? ?? ?? ?? ?? ?? 86 ?? ?? ?? ?? ?? ?? ?? ?? ?? 86"
	);
	/* ScriptedScreenData */
	pointerMap[Sigs::ScriptedScreenData_VTable] = (void*)h_rtti::get_vtable("ScriptedScreenData");
	/* SMainButtonStyle */
	pointerMap[Sigs::SMainButtonStyle_CCTOR] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F9 ?? 7D ?? ?? 07 ?? ?? ?? ?? ?? 7D",
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 51 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F1 ?? 75 ?? ?? 06"
	);
	pointerMap[Sigs::SMainButtonStyle_CopyCCTOR] = Signatures::FindFirst(2,
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 83 EC ?? 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F1 ?? 75 ?? 8B ?? ?? ?? 75",
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 51 56 57 A1 34 ?? ?? ?? 33 C5 50 8D ?? ?? ?? A3 ?? ?? ?? ?? 8B F1 ?? 75 ?? 8B ?? ?? 8B"
	);
	/* Unknown */
	pointerMap[Sigs::Unknown_WinMain] = Signatures::FindFirst(2,
		//Win
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 81 EC ?? ?? ?? ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? ?? 65 ?? 8B ?? ?? 8B",
		//Kong
		"55 8B EC 6A ?? 68 ?? ?? ?? ?? 64 ?? ?? ?? ?? ?? 50 81 EC ?? ?? ?? ?? A1 34 ?? ?? ?? 33 C5 ?? 45 ?? 53 56 57 50 8D ?? ?? ?? A3 ?? ?? ?? ?? ?? 65 ?? 8B ?? ?? 8D ?? ?? ?? ?? ?? 8B"
	);
	/* C/C++ Runtime */
	pointerMap[Sigs::CRT_operator_new] = Signatures::FindFirst(1,
		"55 8B EC EB"
	);
	pointerMap[Sigs::CRT_free] = Signatures::FindFirst(1,
		"55 8b ec ff 75 08 e8 f0 ff ff ff 59 5d c3"
	);

	for (int i = 0; i < (int)Sigs::SIGNATURE_COUNT; i++) {
		if (!GetAddressOf((Sigs)i)) {
			std::string_view enumName = magic_enum::enum_name((Sigs)i);
			Print(LogLevel::ERR, "Failed to find sig '%s'", enumName.data());
		}
	}
}

void* Signatures::GetAddressOf(Sigs sig)
{
	if (!pointerMap.count(sig)) {
		std::string_view enumName = magic_enum::enum_name(sig);
		Print(LogLevel::WARNING, "Sig '%s' not registered in table", enumName.data());
		return nullptr;
	}
	return pointerMap[sig];
}
